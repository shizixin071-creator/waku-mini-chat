# Waku Mini Chat SDK & Demo

这是一个基于 Waku P2P 协议族封装的去中心化聊天系统。本项目不仅实现了一个高性能的聊天应用，还重点封装了一个高度解耦的 **Chat SDK**，满足隐私友好、去中心化的通信需求。

## 项目结构 (Architecture)

- **`src/sdk/WakuChatSDK.js`**: 核心 SDK 类。封装了节点初始化、消息收发、Filter 订阅及 Store 历史消息拉取逻辑。
- **`src/sdk/crypto.js`**: 身份生成与数字签名工具。负责身份标识（FR1）与消息完整性校验（FR5）。
- **`src/App.jsx`**: 基于 SDK 开发的 Web Demo。包含单聊、群聊、撤回显示及本地删除等交互。
- **`docs/design.md`**: 详细的协议设计、Topic 规划及安全边界文档。

## 快速启动 (FR6)

### 1. 安装依赖

在项目根目录下执行：

```bash
npm install @waku/sdk lucide-react
###2. 启动开发环境
bash
复制
npm run dev
启动后访问 http://localhost:5173。
###3. 演示步骤
多端开启：在浏览器中开启两个或多个标签页模拟不同用户。
身份设置：在左下角查看系统生成的唯一 ID，并点击进行昵称修改。
开启私聊：复制 A 端的 ID，在 B 端点击顶部 + 号输入 ID。本系统支持单向开启，B 发送后 A 端会自动弹出对话框。
消息操作：悬浮在消息气泡上，点击 Undo 图标执行全网撤回，点击 Trash 图标执行本地删除。
## 功能达成说明
###FR1. 身份与会话
可持久化身份：基于 sessionStorage 存储密钥对，确保刷新页面后身份不丢失。
会话支持：支持基于排序 ID 的 1:1 单聊和自定义 Topic 的 N:N 群聊。
###FR2. 发送与接收
封装 sendMessage 与 subscribe 接口。内置 BroadcastChannel 本地同步机制，确保在 Waku 节点连接公网期间仍能实现本地秒级通信。
###FR3. 历史消息 (加分项)
集成 Waku Store 协议。SDK 初始化后会自动向 Store 节点拉取最近的历史记录并渲染，解决轻节点离线消息丢失问题。
###FR4. 删除与撤回 (必修项)
撤回 (Revoke)：通过发布 Tombstone (墓碑) 指令实现。客户端验证签名后执行逻辑隐藏，符合去中心化网络无法物理抹除的现实边界。
删除 (Delete)：本地状态过滤，不触发网络广播，不影响其他参与者。
###FR5. 基本安全
完整性：每条消息均附带数字签名，确保只有原发送者有权撤回消息。
机密性：数据采用 JSON 序列化，并预留了 WAKU2-NOISE 加密扩展接口。
## 演示视频
- 演示视频位于项目根目录的 `/video/课题B-演示视频.mp4`。